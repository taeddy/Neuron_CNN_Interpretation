# λ”¥λ¬λ‹ κΈ°λ° μ‹ κ²½μ„Έν¬ μΉΌμ μ΄λ―Έμ§• λ°μ΄ν„° λ¶„μ„
<img alt="Static Badge" src="https://img.shields.io/badge/python-%233776AB?style=for-the-badge&logo=python&logoColor=white"> <img alt="Static Badge" src="https://img.shields.io/badge/pytorch-%23EE4C2C?style=for-the-badge&logo=pytorch&logoColor=white"> <img alt="Static Badge" src="https://img.shields.io/badge/anaconda-%2344A833?style=for-the-badge&logo=anaconda&logoColor=white"> <img alt="Static Badge" src="https://img.shields.io/badge/nvidia-%2376B900?style=for-the-badge&logo=nvidia&logoColor=white">


- μ§„ν–‰κΈ°κ°„: 2021.06 ~ 2022.02
- μ§„ν–‰μΈμ›: 4λ…
- λ‹΄λ‹Ήμ—­ν• : λ°μ΄ν„° μ •μ /κ΄€λ¦¬/λΌλ²¨λ§, μΈκ³µμ§€λ¥ λ¨λΈλ§/ν•™μµ/κ²€μ¦/ν‰κ°€, λ¨λΈ ν•΄μ„
- [Representation (japanese)](https://github.com/taeddy/Neuron_CNN_Interpretation/blob/main/Representation%20(japanese).pdf) β΅οΈ 2022/02/21 in Kobe Univ. Takiguchi LAB
- [Main Code](https://github.com/taeddy/Neuron_CNN_Interpretation/blob/main/Neuron_CNN_Interpretation.ipynb)
- <details>
  <summary>μΈν¬κ·Έλν”½ (ν•κµ­μ–΄)</summary>
  <div markdown="1">
  <img src="https://github.com/user-attachments/assets/cdd25ad7-570d-4ff6-a6d3-0eb3988be6bc">
  </div>
  </details>

---

## π“ λ°°κ²½

- **μ•„λ΅λ””λ‹μ•„ (Allodynia)**: μ •μƒμ μΈ μκ·Ήμ—λ„ ν†µμ¦μ„ λλΌλ” μ‹ κ²½κ³„ μ§ν™.
- λ©”μ»¤λ‹μ¦μ΄ λ¶λ…ν™•ν•μ—¬ μ•½λ¬Ό κ°λ°κ³Ό μΉλ£κ°€ μ–΄λ ¤μ›€.
- μ‹ κ²½μ„Έν¬ ν™λ™μ λ³€ν™”λ¥Ό μ΄ν•΄ν•κΈ° μ„ν• λ‹¤μ–‘ν• μ—°κµ¬κ°€ μ§„ν–‰ μ¤‘.

## β— κΈ°μ΅΄ λ¶„μ„ λ°©λ²•μ λ¬Έμ μ 

- μ‹ κ²½μ„Έν¬λ¥Ό μ΄λ―Έμ§€μ—μ„ μλ™μΌλ΅ μ¶”μ¶ν•΄μ•Ό ν•¨.
- μ„Έν¬ κ°„ κ΄€κ³„λ” μ‚¬λμ΄ μ§μ ‘ λΉ„κµν•΄μ•Ό ν•¨.
- λ°μ΄ν„° μ „μ²λ¦¬, λ‰΄λ° ν™μ„±λ„ νν• κ°„ μƒκ΄€ λ¶„μ„ ν•„μ” β†’ μλ™ν™” μ–΄λ ¤μ›€.

## π― μ—°κµ¬ λ©μ 

- **λ”¥λ¬λ‹(CNN)μ„ ν™μ©ν•΄ μ‹ κ²½μ„Έν¬μ κΈ°λ¥μ  κ²°ν•© λ¶„μ„**.
- κΈ°μ΅΄ λ°©λ²•κ³Όμ μ°¨λ³„μ : μ „μ²λ¦¬ μ—†μ΄ μ΄λ―Έμ§€λ¥Ό κ·Έλ€λ΅ μ‚¬μ©.
- λ―Έμ„Έν• ν™μ„±λ„ μ°¨μ΄κΉμ§€ μΈμ‹ κ°€λ¥ν• λ¨λΈ κµ¬μ¶•.

## π”¬ μ—°κµ¬ λ°©λ²•

- **λ°μ΄ν„°**: μ‹¤ν—μ¥μ λ‰΄λ° μκ·Ή μ λ„ μ „ν›„ μΉΌμ μ΄λ―Έμ§• μμƒ.
- **λ¨λΈ**: CNN ν•™μµ β†’ Grad-CAMμΌλ΅ μ΄λ―Έμ§€μ μ¤‘μ”ν• λ¶€λ¶„ μ‹κ°ν™”.
- **μκ·Ή μ„Έν¬**: μ΄ 24κ° μ„Έν¬ (κ΄‘ μκ·Ή)

## β™οΈ λ¨λΈ κµ¬μ„±

- **μ…λ ¥**: μΉΌμ μ΄λ―Έμ§€ (μμƒ)
- **μ¶λ ¥**: μκ·Ήλ μ„Έν¬ λ²νΈ
- **Grad-CAM**: ν•™μµλ CNNμ„ ν†µν•΄ μ΄λ―Έμ§€ λ‚΄ μ¤‘μ” λ¶€λ¶„ μ‹κ°ν™” (μ¶”κ°€ λ¨λΈ ν•™μµ λ¶ν•„μ”)

## π“ μ‹¤ν— κ²°κ³Ό

- **λ¨λΈ μ •ν™•λ„**
  - ν¬μ—¬ μ§μ „: 92%
  - ν¬μ—¬ 3μΌ ν›„: 85% (μ •ν™•λ„ κ°μ† μ΄μ : μ„Έν¬ κ°„ κ²°ν•© κ°•ν™” μ‹μ‚¬)
- **Grad-CAM λ¶„μ„**
  - μκ·Ήλ μ„Έν¬ κ°„ μ μ‚¬λ„ λΉ„κµ κ°€λ¥
  - ν†µμ¦ μ λ„μ (CFA) ν¬μ—¬ ν›„ μ„Έν¬ κ°„ κΈ°λ¥μ  κ²°ν•© κ°•λ„ μ¦κ°€ ν™•μΈ (208.8 β†’ 262.1)

## β… κ²°λ΅ 

- κ°„λ‹¨ν• CNNμΌλ΅ μ‹ κ²½μ„Έν¬ ν™λ™ λ¶„μ„ κ°€λ¥.
- Grad-CAMμ„ ν†µν•΄ ν†µμ¦ μ λ„ μ „ν›„μ μ„Έν¬ κ²°ν•© λ³€ν™”λ¥Ό μ‹κ°μ μΌλ΅ νμ•… κ°€λ¥.
- ν†µμ¦ μ λ„μ (CFA)μ ν¨κ³Όλ¥Ό μ΄λ―Έμ§€ κΈ°λ°μΌλ΅ κ²€μ¦ κ°€λ¥.

## π”§ ν–¥ν›„ κ³Όμ 

- μΉΌμ μ΄λ―Έμ§• λ°μ΄ν„°μ μ²λ¦¬ λ°©μ‹ κ°μ„ 
- λ¨λΈ ν•™μµ λ°©μ‹μ μµμ ν™”

---

## π§  λ¶€λ΅

### 1. μΉΌμ μ΄λ―Έμ§•μ΄λ€?

- μ‚΄μ•„μλ” λ™λ¬Όμ—μ„ μ‹ κ²½μ„Έν¬ ν™λ™μ„ μ‹κ°ν™”ν•λ” κΈ°μ .
- μΉΌμ μ΄μ¨ λ†λ„ λ³€ν™” β†’ GFP λ‹¨λ°±μ§ κ²°ν•© μ‹ ν•κ΄‘ λ°κ΄‘.

### 2. ν†µμ¦ λ™λ¬Ό λ¨λΈ

- CFA(Complete Freundβ€™s Adjuvant)λ΅ ν†µμ¦ μ λ°.
- ν¬μ—¬ μ§μ „ vs ν¬μ—¬ 3μΌ ν›„ λ°μ΄ν„°λ¥Ό λΉ„κµ λ¶„μ„.

### 3. λ°μ΄ν„° κµ¬μ΅°

- κ° μ„Έν¬μ— λ€ν•΄ μ΄ 10ν κ΄‘ μκ·Ή.
- 1νλ‹Ή 1κ° λλ” 2κ° μ„Έν¬ μκ·Ή.
- κ° ν”„λ μ„μ„ κ°λ³„ λ°μ΄ν„°λ΅ μ²λ¦¬.

### 4. λ¨λΈ ν•™μµ λ°©μ‹

- μκ·Ή μ„Έν¬ λ²νΈλ¥Ό one-hot λΌλ²¨λ΅ μ‚¬μ©.
- μ†μ‹¤ ν•¨μ: Binary Cross Entropy Loss.
- λ°μ΄ν„° ν™•μ¥ λ° λ§μ¤ν‚Ή μ²λ¦¬ μν–‰.

### 5. μ΄λ―Έμ§€ μ μ‚¬λ„ μΈ΅μ •

- CAM κ²°κ³Όλ¬Όμ„ λΉ„κµν•κΈ° μ„ν• μ¥μΉ
- **ZNCC (Zero-mean Normalized Cross-Correlation)** μ‚¬μ©.
- μ΄λ―Έμ§€ κ°„ μ μ‚¬λ„λ¥Ό -1~1λ΅ μ •λ‰ν™”.

