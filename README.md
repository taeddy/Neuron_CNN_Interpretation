# 딥러닝 기반 신경세포 칼슘 이미징 데이터 분석

[Representation (japanese)](https://github.com/taeddy/Neuron_CNN_Interpretation/blob/main/Representation%20(japanese).pdf) ➡️ 2022/02/21 in Kobe Univ. Takiguchi LAB
[인포그래픽 (한국어)](https://github.com/taeddy/Neuron_CNN_Interpretation/blob/main/Infographic.pdf)


## 📌 배경

- **아로디니아 (Allodynia)**: 정상적인 자극에도 통증을 느끼는 신경계 질환.
- 메커니즘이 불명확하여 약물 개발과 치료가 어려움.
- 신경세포 활동의 변화를 이해하기 위한 다양한 연구가 진행 중.

## ❗ 기존 분석 방법의 문제점

- 신경세포를 이미지에서 수동으로 추출해야 함.
- 세포 간 관계는 사람이 직접 비교해야 함.
- 데이터 전처리, 뉴런 활성도 파형 간 상관 분석 필요 → 자동화 어려움.

## 🎯 연구 목적

- **딥러닝(CNN)을 활용해 신경세포의 기능적 결합 분석**.
- 기존 방법과의 차별점: 전처리 없이 이미지를 그대로 사용.
- 미세한 활성도 차이까지 인식 가능한 모델 구축.

## 🔬 연구 방법

- **데이터**: 실험쥐의 뉴런 자극 유도 전후 칼슘 이미징 영상.
- **모델**: CNN 학습 → Grad-CAM으로 이미지의 중요한 부분 시각화.
- **자극 세포**: 총 24개 세포 (광 자극)

## ⚙️ 모델 구성

- **입력**: 칼슘 이미지 (영상)
- **출력**: 자극된 세포 번호
- **Grad-CAM**: 학습된 CNN을 통해 이미지 내 중요 부분 시각화 (추가 모델 학습 불필요)

## 📈 실험 결과

- **모델 정확도**
  - 투여 직전: 92%
  - 투여 3일 후: 85% (정확도 감소 이유: 세포 간 결합 강화 시사)
- **Grad-CAM 분석**
  - 자극된 세포 간 유사도 비교 가능
  - 통증 유도제(CFA) 투여 후 세포 간 기능적 결합 강도 증가 확인 (208.8 → 262.1)

## ✅ 결론

- 간단한 CNN으로 신경세포 활동 분석 가능.
- Grad-CAM을 통해 통증 유도 전후의 세포 결합 변화를 시각적으로 파악 가능.
- 통증 유도제(CFA)의 효과를 이미지 기반으로 검증 가능.

## 🔧 향후 과제

- 칼슘 이미징 데이터의 처리 방식 개선
- 모델 학습 방식의 최적화

---

## 🧠 부록

### 1. 칼슘 이미징이란?

- 살아있는 동물에서 신경세포 활동을 시각화하는 기술.
- 칼슘 이온 농도 변화 → GFP 단백질 결합 시 형광 발광.

### 2. 통증 동물 모델

- CFA(Complete Freund’s Adjuvant)로 통증 유발.
- 투여 직전 vs 투여 3일 후 데이터를 비교 분석.

### 3. 데이터 구조

- 각 세포에 대해 총 10회 광 자극.
- 1회당 1개 또는 2개 세포 자극.
- 각 프레임을 개별 데이터로 처리.

### 4. 학습 방식

- 자극 세포 번호를 one-hot 라벨로 사용.
- 손실 함수: Binary Cross Entropy Loss.
- 데이터 증강 및 마스킹 처리 수행.

### 5. 이미지 유사도 측정

- **ZNCC (Zero-mean Normalized Cross-Correlation)** 사용.
- 이미지 간 유사도를 -1~1로 정량화.

