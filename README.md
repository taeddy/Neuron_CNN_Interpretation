# λ”¥λ¬λ‹ κΈ°λ° μ‹ κ²½μ„Έν¬ μΉΌμ μ΄λ―Έμ§• λ°μ΄ν„° λ¶„μ„
<img alt="Static Badge" src="https://img.shields.io/badge/python-%233776AB?style=for-the-badge&logo=python&logoColor=white"> <img alt="Static Badge" src="https://img.shields.io/badge/pytorch-%23EE4C2C?style=for-the-badge&logo=pytorch&logoColor=white"> <img alt="Static Badge" src="https://img.shields.io/badge/anaconda-%2344A833?style=for-the-badge&logo=anaconda&logoColor=white"> <img alt="Static Badge" src="https://img.shields.io/badge/nvidia-%2376B900?style=for-the-badge&logo=nvidia&logoColor=white">


- μ§„ν–‰κΈ°κ°„: 2021.06 ~ 2022.02
- μ§„ν–‰μΈμ›: 4λ…
- λ‹΄λ‹Ήμ—­ν• : λ°μ΄ν„° μ •μ /κ΄€λ¦¬/λΌλ²¨λ§, μΈκ³µμ§€λ¥ λ¨λΈλ§/ν•™μµ/κ²€μ¦/ν‰κ°€, λ¨λΈ ν•΄μ„
- [Representation (japanese)](https://github.com/taeddy/Neuron_CNN_Interpretation/blob/main/Representation%20(japanese).pdf) β΅οΈ 2022/02/21 in Kobe Univ. Takiguchi LAB
- [Main Code](https://github.com/taeddy/Neuron_CNN_Interpretation/blob/main/Neuron_CNN_Interpretation.ipynb)
- <details>
  <summary>μΈν¬κ·Έλν”½ (ν•κµ­μ–΄)</summary>
  <div markdown="1">
  <img src="https://github.com/user-attachments/assets/cdd25ad7-570d-4ff6-a6d3-0eb3988be6bc">
  </div>
  </details>

---

## π“ λ°°κ²½

- **ν™μƒν†µ (Allodynia)**: μ •μƒμ μΈ μκ·Ήμ—λ„ ν†µμ¦μ„ λλΌλ” μ‹ κ²½κ³„ μ§ν™.
- λ©”μ»¤λ‹μ¦μ΄ λ¶λ…ν™•ν•μ—¬ μ•½λ¬Ό κ°λ°κ³Ό μΉλ£κ°€ μ–΄λ ¤μ›€.
- μ‹ κ²½μ„Έν¬ ν™λ™μ λ³€ν™”λ¥Ό μ΄ν•΄ν•κΈ° μ„ν• λ‹¤μ–‘ν• μ—°κµ¬κ°€ μ§„ν–‰ μ¤‘.

## β— κΈ°μ΅΄ λ¶„μ„ λ°©λ²•μ λ¬Έμ μ 

- μ‹ κ²½μ„Έν¬μ μ„μΉμ™€ κ°μλ¥Ό μ‚¬λμ΄ μ΄λ―Έμ§€λ¥Ό λ³΄κ³  νλ‹¨ν•μ—¬ μ§€μ •ν•΄ μ£Όμ–΄μ•Ό ν•¨.
- μ„Έν¬ κ°„ κ΄€κ³„λ¥Ό νμ•…ν•κΈ° μ„ν•΄ ν†µκ³„μ  κΈ°λ²•μ„ μ„ νƒν•΄μ•Ό ν•κ³ , κΈ°λ²•μ— λ”°λΌ κ²°κ³Όκ°€ λ‹¬λΌμ§.
- λ‰΄λ°μ ν™μ„± κΈ°μ¤€μΉλ¥Ό μ •ν•λ” κ²ƒμ΄ λ¨νΈν•¨.
- μƒκΈ° μ΄μ λ΅ μΈν•΄ μλ™ν™”κ°€ μ–΄λ ¤μ›€.

## π― μ—°κµ¬ λ©μ 

- **λ”¥λ¬λ‹(CNN)μ„ ν™μ©ν•΄ μ‹ κ²½μ„Έν¬μ κΈ°λ¥μ  κ²°ν•© λ¶„μ„**.
- κΈ°μ΅΄ λ°©λ²•κ³Όμ μ°¨λ³„μ : μ „μ²λ¦¬ μ—†μ΄ μ΄λ―Έμ§€λ¥Ό κ·Έλ€λ΅ μ‚¬μ©. -> κ³Όμ • μλ™ν™”
- λ―Έμ„Έν• ν™μ„±λ„ μ°¨μ΄κΉμ§€ μΈμ‹ κ°€λ¥ν• λ¨λΈ κµ¬μ¶•.

## π”¬ μ—°κµ¬ λ°©λ²•

- **λ°μ΄ν„°**
  - μ‹¤ν—μ¥μ λ‰΄λ°μ„ μΉΌμ μ΄λ―Έμ§• κΈ°λ²•μΌλ΅ κ΄€μΈ΅
  - 2κ° μ‹μ 
    - ν‰μ‹ λ‰΄λ° μ΄λ―Έμ§€
    - νΉμ • λ‰΄λ° μκ·Ή μ§ν›„ 2.5μ΄μ μ΄λ―Έμ§€
  - CFAμ„ ν¬μ—¬ν• ν›„μ λ°μ΄ν„°
    - CFA: μ—Όμ¦μ λ°μ  (μ—Όμ¦μΌλ΅ μΈν•΄ λ‰΄λ°κ°„ κ²°ν•©μ΄ κ°•ν™”λ  κ²ƒμΌλ΅ μ‚¬λ£λ¨)
    - μ•½λ¬Ό ν¬μ—¬μ— λ”°λ¥Έ ν™λ™ ν¨ν„΄μ„ λΉ„κµν•κΈ° μ„ν•¨
- **λ¨λΈ**
  - CNNμ„ μ΄μ©ν•μ—¬ ν•™μµ β†’ Grad-CAMμΌλ΅ CNNμ΄ μ΄λ―Έμ§€λ¥Ό νλ³„ν•  λ•μ κΈ°μ¤€μ„ ν•΄μ„
- **μκ·Ή μ„Έν¬ λ° λ°©λ²•**
  - μ΄ 24κ° μ„Έν¬
  - λ°©μ‚¬μ„ μ„ μ΄μ©ν• κ΄‘ μκ·Ή

## β™οΈ λ¨λΈ κµ¬μ„±

- **μ…λ ¥**: μΉΌμ μ΄λ―Έμ§€
- **μ¶λ ¥**: μκ·Ήλ μ„Έν¬μ λΌλ²¨
- **λ¨λΈ λ‚΄λ¶€ κµ¬μ΅°**
  <img width="1377" alt="image" src="https://github.com/user-attachments/assets/1d1c5606-7bab-468c-bbda-bb84bfa817b0" />
- **Grad-CAM**: ν•™μµλ CNNμ„ ν†µν•΄ μ΄λ―Έμ§€ λ‚΄ μ¤‘μ” λ¶€λ¶„ μ‹κ°ν™” (μ¶”κ°€ λ¨λΈ ν•™μµ λ¶ν•„μ”)

## π“ μ‹¤ν— κ²°κ³Ό

- **λ¨λΈ μ •ν™•λ„**
  - CFA ν¬μ—¬ μ΄μ „: 92%
  - CFA ν¬μ—¬ 3μΌ ν›„: 85%
    - μ •ν™•λ„ κ°μ† μ΄μ : **μ„Έν¬ κ°„ κ²°ν•© κ°•ν™” μ‹μ‚¬**
- **Grad-CAM λ¶„μ„**
  - κ° μ„Έν¬μ CAM κ²°κ³Όλ¥Ό μ·¨ν•©ν•μ—¬ λΉ„κµν•¨μΌλ΅μ¨ μκ·Ήλ μ„Έν¬ κ°„ ν™λ™ ν¨ν„΄ μ μ‚¬λ„ λΉ„κµκ°€ κ°€λ¥ν•¨.
  - CFA ν¬μ—¬ ν›„ μ„Έν¬ κ°„ κΈ°λ¥μ  κ²°ν•© κ°•λ„ μ¦κ°€κ°€ ν™•μΈλ¨.
    - CAM κ²°κ³Ό κ°„ μƒκ΄€μΉκ°€ 208.8 μ—μ„ 262.1 λ΅ μ¦κ°€ν•μ€μ.

## β… κ²°λ΅ 

- κ°„λ‹¨ν• CNNμΌλ΅ μ‹ κ²½μ„Έν¬ ν™λ™ λ¶„μ„ κ°€λ¥.
- Grad-CAMμ„ ν†µν•΄ ν†µμ¦ μ λ„ μ „ν›„μ μ„Έν¬ κ²°ν•© λ³€ν™”λ¥Ό μ‹κ°μ μΌλ΅ νμ•… κ°€λ¥.
- ν†µμ¦ μ λ„μ (CFA)μ ν¨κ³Όλ¥Ό μ΄λ―Έμ§€ κΈ°λ°μΌλ΅ κ²€μ¦ κ°€λ¥.

## π”§ ν–¥ν›„ κ³Όμ 

- μΉΌμ μ΄λ―Έμ§• λ°μ΄ν„°μ μ²λ¦¬ λ°©μ‹ κ°μ„ 
  - ν–¥ν›„ μ‹κ³„μ—΄ λ°μ΄ν„°λΌλ” νΉμ§•μ„ ν™μ©ν•λ©΄ μ›”λ“±ν ν–¥μƒλ κ²°κ³Όλ¥Ό ν™•λ³΄ν•  μ μμ„ κ²ƒμΌλ΅ μμƒλ¨.
  - λ³Έ μ—°κµ¬μ—μ„λ” νΉμ • ν™κ²½μ—μ„λ§ λ°μ΄ν„°λ¥Ό ν™•λ³΄ν• μ μκ³ , κ·Έμ— λ”°λΌ μ‹κ°„μ  ν•κ³„λ΅ μΈν•μ—¬ λ°μ΄ν„°μ μ–‘μ΄ μ¶©λ¶„ν•μ§€ λ»ν•μ€μ. λ”°λΌμ„ νΉμ • λ‰΄λ°μ„ μκ·Ήν•λ©΄ 2.5μ΄ μ΄λ‚΄μ— κ°•ν• μ—°μ‡„λ°μ‘μ΄ μ§€μ†λλ‹¤λ” μ μ—λ§ μ°©μ•ν•μ€κ³ , μ‹κ³„μ—΄μ„μ„ λ¬΄μ‹ν•μ—¬ λ‹¨μΌ μ΄λ―Έμ§€λ΅ λ¶„μ„ν•¨.
- μ •κµν• μ‹λ³„μ„ μ„ν• λ¨λΈ κµ¬μ΅° κµ¬μ²΄ν™”
  - λ¨λΈμ μ •ν™•λ„λ¥Ό ν–¥μƒμ‹ν‚¤κΈ° μ„ν•΄μ„λ” λ¨λΈμ„ κµ¬μ²΄ν™”ν•μ—¬ νλΌλ―Έν„°λ¥Ό λλ ¤μ•Ό ν•¨.
  - ν•μ§€λ§ μ΄μ— λ”°λΌ ν’λ¶€ν• λ°μ΄ν„°κ°€ ν•„μ”ν•μ—¬ μ•„λμ κ³Όμ κ°€ μ„ ν–‰λμ–΄μ•Ό ν•¨.
- λ‹¤μ–‘ν• λ°μ΄ν„°μ ν™•λ³΄
  - κ°™μ€ λ¶€μ„μ μ‹ κ²½μ„Έν¬λ¥Ό μ¥κΈ°κ°„ κ΄€μΈ΅ν•λ©° κ΄‘ μκ·Ήμ„ κ°€ν•λ” κ²ƒμ€ λ¬Όλ¦¬μ μΈ ν•κ³„κ°€ μμ.
  - λ”°λΌμ„ λ‰΄λ° λ°°μΉμ™€ κ°μμ— μƒκ΄€μ—†μ΄ λ¨λΈ μ„±λ¥μ΄ μΌλ°ν™” λλ„λ΅ λ‹¤μ–‘ν• λ°μ΄ν„°κ°€ ν•„μ”ν•¨.
    - λ°μ΄ν„° ν™•μ¥ (Data Augmentation)μΌλ΅ μ΄λ¥Ό μΌλ¶€ κµ¬ν„ κ°€λ¥ν•¨. (μ΄λ―Έ μ—°κµ¬μ— μ μ©λμ–΄ μμ)

---

## π§  λ¶€λ΅

### 1. μΉΌμ μ΄λ―Έμ§•μ΄λ€?

- μ‚΄μ•„μλ” λ™λ¬Όμ—μ„ μ‹ κ²½μ„Έν¬ ν™λ™μ„ μ‹κ°ν™”ν•λ” κΈ°μ .
- μΉΌμ μ΄μ¨ λ†λ„ λ³€ν™” β†’ GFP λ‹¨λ°±μ§ κ²°ν•© μ‹ ν•κ΄‘ λ°κ΄‘.

### 2. λ°μ΄ν„° κµ¬μ΅°

- κ° μ„Έν¬μ— λ€ν•΄ μ΄ 10ν κ΄‘ μκ·Ή.
- 1νλ‹Ή 1κ° λλ” 2κ° μ„Έν¬ μκ·Ή.
- κ° ν”„λ μ„μ„ κ°λ³„ λ°μ΄ν„°λ΅ μ²λ¦¬.

### 3. λ¨λΈ ν•™μµ λ°©μ‹

- μκ·Ή μ„Έν¬ λ²νΈλ¥Ό one-hot λΌλ²¨λ΅ μ‚¬μ©.
- μ†μ‹¤ ν•¨μ: Binary Cross Entropy Loss.
- λ°μ΄ν„° ν™•μ¥ λ° λ§μ¤ν‚Ή μ²λ¦¬ μν–‰.

### 4. μ΄λ―Έμ§€ μ μ‚¬λ„ μΈ΅μ •

- CAM κ²°κ³Όλ¬Όμ„ λΉ„κµν•κΈ° μ„ν• μ¥μΉ
- **ZNCC (Zero-mean Normalized Cross-Correlation)** μ‚¬μ©.
- μ΄λ―Έμ§€ κ°„ μ μ‚¬λ„λ¥Ό -1~1λ΅ μ •λ‰ν™”.

